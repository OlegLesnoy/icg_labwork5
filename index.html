<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name='title' content='TextureTransformFull.x3d'/> 
  <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
  <meta name='reference' content='LineSet.x3d'/> 
  <meta name='title' content='IndexedLineSet.x3d'/> 
  <title>Lesnoy 5th Lab</title>
  <script type='text/javascript' src='https://www.x3dom.org/download/x3dom.js'> </script>
  <link rel='stylesheet' type='text/css' href='https://www.x3dom.org/download/x3dom.css'/>
  <script src="https://www.x3dom.org/download/dev/x3dom-full.js"></script>
  <link rel="stylesheet" href="../css/custom.css" />
  <script src="../js/custom.js"></script>
  <script>
    function move(point) 
    {
      document.getElementById('TrainCh').setAttribute('set_destination', point[0]+' '+parseFloat(point[1]+1.46)+' '); 
    }
  </script>
  <script>
    function randomcolor()
    {
      var clr = document.getElementById('myMat');
      clr.setAttribute("diffusecolor", " " + Math.random() + " " + Math.random() + " " + Math.random());
    }  
  </script>
</head>
<body>
  <h1>Oleg Lesnoy Group 4742</h1>
  <x3d width='1280px' height='780px'>
    <scene>
      <Fog visibilityRange='100' fogType= "Linear"></Fog>
      <PointLight location="2 3 3" color="1 1 1" intensity="1" shadowIntensity="0.7" shadowMapSize="512"></PointLight>
      <Viewpoint position='5 3 40' orientation="10 1 10" centerOfRotation="10 1 1 0" ></Viewpoint> 
      <Background 
      frontUrl="https://img3.badfon.ru/wallpaper/big/2/92/peyzazh-zima-sneg-snezhnaya.jpg" 
      backUrl="https://img3.badfon.ru/wallpaper/big/2/92/peyzazh-zima-sneg-snezhnaya.jpg" 
      bottomUrl="https://pp.userapi.com/c855720/v855720137/efc2/N4M-3bK8GWQ.jpg"
      leftUrl="https://img3.badfon.ru/wallpaper/big/2/92/peyzazh-zima-sneg-snezhnaya.jpg" 
      rightUrl="https://img3.badfon.ru/wallpaper/big/2/92/peyzazh-zima-sneg-snezhnaya.jpg"
      topUrl="https://pp.userapi.com/c855720/v855720137/efc2/N4M-3bK8GWQ.jpg">
    </Background>
    <Transform translation="-10 -1.4 -10" rotation="0 0 0 0" onclick="move(event.hitPnt);"> <!----basis---->
      <Shape>
        <IndexedFaceSet ccw="true" colorPerVertex="true" convex="true" creaseAngle="0" normalPerVertex="true" solid="false" 
        coordIndex='1 2 3 0 -1'
        colorIndex='0 1 2 3 -1'>     
        <Coordinate point='-1 0 30, 60 0 30, 60 0 -20, -1 0 -20'> </Coordinate>
      </IndexedFaceSet>
      <appearance>
        <Material></Material>
        <ImageTexture url="https://thumbs.dreamstime.com/b/снег-зимы-взгляд-сверху-текстуры-снега-текстура-для-дизайна-белизны-128315802.jpg" repeatS="true" repeatT="true">   
        </ImageTexture>
        <TextureTransform rotation='1.5708' scale="3 2" translation='0.33 0.5'></TextureTransform>
        </appearance>
      </Shape>
    </Transform>
    <Collision enabled = "true">
      <PositionChaser DEF='TrainCh' id='TrainCh' duration='3' initialDestination='0 0 0'></PositionChaser>
      <Transform onClick="move(event.hitPnt);" translation='0 1 0'>
        <transform DEF='train' translation='0 0.2 0' rotation='0 0 0 0' onclick='select("TrainCh") '>
          <Group DEF = "CylinderAndBoxAndCabinAndConeAndSnoutAndSphereAndTyreAndWheelAndWindow1AndWindow2"  translation ='0 0 0' rotation = '0 0 0 0' >
            <transform translation='0 0 0' rotation='0 0 2 1.55'> <!---train body--->
              <Anchor url="https://ru.wikipedia.org/wiki/%D0%9F%D0%B0%D1%80%D0%BE%D0%B2%D0%BE%D0%B7" parameter="target='_self'">
                <shape DEF="Cylinder">                                                 
                  <appearance>
                    <Material></Material>
                    <ImageTexture url="https://2.bp.blogspot.com/-wbMKGGOgO3Y/XAFWLtRdmLI/AAAAAAAALi8/3HD7Hr3PRXwu3yFnx8M4IdkvEembSDrJACLcBGAs/s640/metall_setka_treschiny_carapiny_chb_tekstura_1920x1200.jpg" repeatS="true" repeatT="true"></ImageTexture>
                    <TextureTransform rotation='1.5708' scale="1 1" translation='0.33 0.5'></TextureTransform>
                    </appearance>
                    <cylinder radius = "1" height = "4.3" ></cylinder>
                  </shape>   
                </Anchor> 
                <transform translation='-1.2 0.87  0' rotation='1 0 0 0'> <!--train platform--->
                  <shape DEF = "Box">
                    <appearance>
                      <material DEF='TrainColor' id='myMat' diffuseColor='#000000'></material>
                    </appearance>
                    <box size="0.5 6 2"></box>
                  </shape>
                  <transform translation='1.5 2 0' rotation='1 0 0 0'> <!--cabin--->
                    <shape DEF = "Cabin" >
                      <appearance>
                        <material USE ="TrainColor"></material>
                      </appearance>
                      <box size="2.5 2 2"></box>
                    </shape>
                    <transform translation='1.1 -4 0' rotation='0 0 1 7.9'> <!--funnel--->        
                      <shape DEF = "Cone">
                        <appearance>
                          <material diffuseColor='#600000'></material>
                        </appearance>
                        <cone bottomRadius='0.4' height='0.9' topRadius='0.1' ></cone>
                      </shape>
                      <transform translation='-0.50 3 0' rotation='0 0.75 0 -2.4'> <!--track cleaner-->   
                        <shape DEF = "Snout">
                          <appearance>
                            <material diffuseColor='#008000'></material>
                          </appearance>
                          <snout dbottom='0.5' dtop='2.5' height='1.2' xoff='1' yoff='1'></snout> 
                        </shape>
                      </transform>
                    </transform>
                  </transform>
                </transform>
                <transform translation='0 -1.5 0' rotation='0 0.75 0 -2.4'> <!--front part-->   
                  <shape DEF = "Sphere">
                    <appearance>
                      <material diffuseColor='#708090'></material>
                    </appearance>
                    <sphere radius="1"></sphere> 
                  </shape>
                </transform>
                <transform translation='-1.7 2.5 1' rotation='1.5 -2 2 4'>  <!--right back wheel-->   
                  <shape DEF = "Wheel">
                    <appearance>
                      <material diffuseColor='#708090'></material>
                    </appearance>
                    <cylinder radius = "0.6" height ="0.2" ></cylinder>
                  </shape>
                  <transform translation='-0.01 -0.011 0' rotation='0.3 -3 3 3'> <!--tyre-->   
                    <shape DEF = "Tyre">
                      <appearance>
                        <material diffuseColor='#FFFF00'></material>
                      </appearance>
                      <torus innerRadius="0.1" outerRadius="0.63"></torus>
                    </shape>
                  </transform>
                </transform>
                <transform translation='-1.7 0.80 1' rotation='1.5 -2 2 4'> <!--right middle wheel-->   
                  <shape DEF = "Wheel">
                    <appearance>
                      <material diffuseColor='#708090'></material>
                    </appearance>
                    <cylinder radius = "0.6" height ="0.2" ></cylinder>
                  </shape>
                  <transform translation='-0.01 -0.011 0' rotation='0.3 -3 3 3'> <!--tyre-->   
                    <shape DEF = "Tyre">
                      <appearance>
                        <material diffuseColor='#FFFF00'></material>
                      </appearance>
                      <torus innerRadius="0.1" outerRadius="0.63"></torus>
                    </shape>
                  </transform>
                </transform>
                <transform translation='-1.7 -0.90 1' rotation='1.5 -2 2 4'> <!--right front wheel-->   
                  <shape DEF = "Wheel">
                    <appearance>
                      <material diffuseColor='#708090'></material>
                    </appearance>
                    <cylinder radius = "0.6" height ="0.2" ></cylinder>
                  </shape>
                  <transform translation='-0.01 -0.011 0' rotation='0.3 -3 3 3'> <!--tyre-->   
                    <shape DEF = "Tyre">
                      <appearance>
                        <material diffuseColor='#FFFF00'></material>
                      </appearance>
                      <torus innerRadius="0.1" outerRadius="0.63"></torus>
                    </shape>
                  </transform>
                </transform>
                <transform translation='-1.7 2.5 -1' rotation='1.5 -2 2 4'> <!--left back wheel-->   
                  <shape DEF = "Wheel">
                    <appearance>
                      <material diffuseColor='#708090'></material>
                    </appearance>
                    <cylinder radius = "0.6" height ="0.2" ></cylinder>
                  </shape>
                  <transform translation='-0.01 -0.011 0' rotation='0.3 -3 3 3'> <!--tyre-->   
                    <shape DEF = "Tyre">
                      <appearance>
                        <material diffuseColor='#FFFF00'></material>
                      </appearance>
                      <torus innerRadius="0.1" outerRadius="0.63"></torus>
                    </shape>
                  </transform>
                </transform>
                <transform translation='-1.7 0.80 -1' rotation='1.5 -2 2 4'> <!--left middle wheel-->   
                  <shape DEF = "Wheel" >
                    <appearance>
                      <material diffuseColor='#708090'></material>
                    </appearance>
                    <cylinder radius = "0.6" height ="0.2" ></cylinder>
                  </shape>
                  <transform translation='-0.01 -0.011 0' rotation='0.3 -3 3 3'> <!--tyre-->   
                    <shape DEF = "Tyre">
                      <appearance>
                        <material diffuseColor='#FFFF00'></material>
                      </appearance>
                      <torus innerRadius="0.1" outerRadius="0.63"></torus>
                    </shape>
                  </transform>
                </transform>
                <transform translation='-1.7 -0.90 -1' rotation='1.5 -2 2 4'> <!--right front wheel-->   
                  <shape DEF = "Wheel">
                    <appearance>
                      <material diffuseColor='#708090'></material>
                    </appearance>
                    <cylinder radius = "0.6" height ="0.2" ></cylinder>
                  </shape>
                  <transform translation='-0.01 -0.011 0' rotation='0.3 -3 3 3'> <!--tyre-->   
                    <shape DEF = "Tyre">
                      <appearance>
                        <material diffuseColor='#FFFF00'></material>
                      </appearance>
                      <torus innerRadius="0.1" outerRadius="0.63"></torus>
                    </shape>
                  </transform>
                </transform>
                <transform translation='0.45 2.9 -0.91' rotation='1 0 0 0'> <!--left window--->
                  <shape DEF = "Window1">
                    <appearance>
                      <material diffuseColor='#00FFFF'></material>
                    </appearance>
                    <box size="1.7 1.5 0.2"></box>
                  </shape>
                </transform>
                <transform translation='0.45 2.9 0.91' rotation='1 0 0 0'> <!--right window--->
                  <shape DEF = "Window2">
                    <appearance>
                      <material diffuseColor='#00FFFF'></material>
                    </appearance>
                    <box size="1.7 1.5 0.2"></box>
                  </shape>
                </transform>
              </transform>
              </Group>
            </transform>
          </Transform>
            </Collision>
            <transform translation="0 0.75 0" rotation=" 0 0 0.01 1.57">
              <Group DEF='RailAndCross-tieTogether' translation ='0 0 0' rotation = '0 0 0 0'>
                <transform DEF="Rail"  translation='-2.1 -2 -1 ' rotation='0 0 0 0'> <!---rail-->
                  <Shape DEF = "Rail">
                    <Appearance>
                      <Material></Material>
                      <ImageTexture url="https://st.depositphotos.com/1003592/2370/i/450/depositphotos_23705891-stock-photo-scratched-metal-surface.jpg" repeatS="true" repeatT="true"></ImageTexture>
                    </Appearance>
                    <Box size="0.2 25 0.1"></Box>
                  </Shape>
                </transform>    
                <Transform translation="-2.1 -2 1"  rotation= "0 0 0 0">
                  <Shape USE="Rail">
                  </Shape>
                </Transform>
                <Transform translation="-2.1 -27.013 1"  rotation= "0 0 0 0">
                  <Shape USE="Rail">
                  </Shape>
                </Transform>
                <Transform translation="-2.1 -27.013 -1"  rotation= "0 0 0 0">
                  <Shape USE="Rail">
                  </Shape>
                </Transform>
                <transform DEF="Cross-tie"  translation='-2.1 -2 0' rotation='0 0 0 0'> <!---cross-tie-->
                  <Shape DEF = "Cross-tie">
                    <Appearance>
                      <Material></Material>
                      <ImageTexture url="https://st.depositphotos.com/1003592/2370/i/450/depositphotos_23705891-stock-photo-scratched-metal-surface.jpg" repeatS="true" repeatT="true"></ImageTexture>
                    </Appearance>
                    <Box size="0.1 0.2 3"></Box>
                  </Shape>
                </transform>    
                <transform translation='-2.1 0 0' rotation='0 0 0 0'> <!---cross-tie-->
                  <Shape USE = "Cross-tie">
                  </Shape>
                </transform>        
                <transform translation='-2.1 2 0' rotation='0 0 0 0'> <!---cross-tie-->
                  <Shape USE = "Cross-tie">
                  </Shape>
                </transform>    
                <transform translation='-2.1 4 0' rotation='0 0 0 0'> <!---cross-tie-->
                  <Shape USE = "Cross-tie">
                  </Shape>
                </transform>   
                <transform translation='-2.1 6 0' rotation='0 0 0 0'> <!---cross-tie-->
                  <Shape USE = "Cross-tie">
                  </Shape>
                </transform>     
                <transform translation='-2.1 8 0' rotation='0 0 0 0'> <!---cross-tie-->
                  <Shape USE = "Cross-tie">
                  </Shape>
                </transform> 
                <transform translation='-2.1 -4 0' rotation='0 0 0 0'><!---cross-tie-->
                  <Shape USE = "Cross-tie">
                  </Shape>
                </transform>    
                <transform translation='-2.1 -6 0' rotation='0 0 0 0'> <!---cross-tie-->
                  <Shape USE = "Cross-tie">
                  </Shape>
                </transform>    
                <transform translation='-2.1 -8 0' rotation='0 0 0 0'> <!---cross-tie-->
                  <Shape USE = "Cross-tie">
                  </Shape>
                </transform>  
                <transform translation='-2.1 -10 0' rotation='0 0 0 0'> <!---cross-tie-->
                  <Shape USE = "Cross-tie">
                  </Shape>
                </transform>      
                <transform translation='-2.1 -12 0' rotation='0 0 0 0'> <!---cross-tie-->
                  <Shape USE = "Cross-tie">
                  </Shape>
                </transform>    
                <transform translation='-2.1 -14 0' rotation='0 0 0 0'> <!---cross-tie-->
                  <Shape USE = "Cross-tie">
                  </Shape>
                </transform>   
                <transform translation='-2.1 -16 0' rotation='0 0 0 0'> <!---cross-tie-->
                  <Shape USE = "Cross-tie">
                  </Shape>
                </transform>   
                <transform translation='-2.1 -18 0' rotation='0 0 0 0'> <!---cross-tie-->
                  <Shape USE = "Cross-tie">
                  </Shape>
                </transform>   
                <transform translation='-2.1 -20 0' rotation='0 0 0 0'> <!---cross-tie-->
                  <Shape USE = "Cross-tie">
                  </Shape>
                </transform>  
                <transform translation='-2.1 -22 0' rotation='0 0 0 0'> <!---cross-tie-->
                  <Shape USE = "Cross-tie">
                  </Shape>
                </transform>  
                <transform translation='-2.1 -24 0' rotation='0 0 0 0'> <!---cross-tie-->
                  <Shape USE = "Cross-tie">
                  </Shape>
                </transform>  
                <transform translation='-2.1 -26 0' rotation='0 0 0 0'> <!---cross-tie-->
                  <Shape USE = "Cross-tie">
                  </Shape>
                </transform>  
                <transform translation='-2.1 -28 0' rotation='0 0 0 0'> <!---cross-tie-->
                  <Shape USE = "Cross-tie">
                  </Shape>
                </transform>  
                <transform translation='-2.1 -30 0' rotation='0 0 0 0'> <!---cross-tie-->
                  <Shape USE = "Cross-tie">
                  </Shape>
                </transform>  
                <transform translation='-2.1 -32 0' rotation='0 0 0 0'> <!---cross-tie-->
                  <Shape USE = "Cross-tie">
                  </Shape>
                </transform>  
                <transform translation='-2.1 -34 0' rotation='0 0 0 0'> <!---cross-tie-->
                  <Shape USE = "Cross-tie">
                  </Shape>
                </transform>  
                <transform translation='-2.1 -36 0' rotation='0 0 0 0'> <!---cross-tie-->
                  <Shape USE = "Cross-tie">
                  </Shape>
                </transform>  
              </Group>
            </transform>
              <Transform translation= '-1.69 -5.4 -15' rotation =' 1.5 2 -3 1.8'> 
                <TimeSensor DEF='Time1' cycleInterval='8' loop='true'></TimeSensor> <!-----mountain--->
                <CoordinateInterpolator DEF='CoordInt' key='0 0.2 0.4 0.6 0.8 1'
                keyValue= '11 0 -0.2, 9 0 1, 8 8 1,  9 0 1, 8 0 -1, 8 7 1,  4 0 -3, 8 0 -1, 8 8 1,  4 0 -3, 8 0 -3, 8 8 1,   12 0 -1, 8 0 -3, 8 8 1,  12 0 1, 12 0 -1, 8 8 1,  11 0 0, 12 0 1, 8 8 1
                11 0 -0.2, 9 0 1, 8 8 1,  9 0 1, 8 0 -1, 8 7 1,  4 0 -3, 8 0 1, 8 8 1,  4 0 -3, 8 0 -3, 8 8 1,   12 0 -1, 8 0 -3, 8 8 1,  12 0 1, 12 0 -1, 8 8 1,  11 0 0, 12 0 1, 8 8 1
                11 0 -0.2, 9 0 5, 8 8 1,  9 0 1, 8 0 -1, 8 10 1,  4 0 -3, 8 0 1, 8 8 1,  4 0 -3, 8 0 -3, 8 8 1,   12 0 -1, 8 0 -3, 8 8 1,  12 0 1, 12 0 -1, 8 8 1,  11 0 0, 12 0 1, 8 8 1
                11 0 -0.2, 9 0 5, 8 8 1,  9 0 1, 8 0 -1, 8 10 1,  4 0 -3, 8 0 1, 8 8 1,  4 0 -3, 8 0 -3, 8 8 1,   12 0 -1, 8 0 -3, 8 8 1,  12 0 1, 12 0 -1, 8 8 1,  11 0 0, 12 0 1, 8 8 1
                11 0 -0.2, 9 0 1, 8 8 1,  9 0 1, 8 0 -1, 8 10 1,  4 0 -3, 8 0 -1, 8 8 1,  4 0 -3, 8 0 -3, 8 8 1,   12 0 -1, 8 0 -3, 8 8 1,  12 0 1, 12 0 -1, 8 8 1,  11 0 0, 12 0 1, 8 8 1
                11 0 -0.2, 9 0 1, 8 8 1,  9 0 1, 8 0 -1, 8 7 1,  4 0 -3, 8 0 -1, 8 8 1,  4 0 -3, 8 0 -3, 8 8 1,   12 0 -1, 8 0 -3, 8 8 1,  12 0 1, 12 0 -1, 8 8 1,  11 0 0, 12 0 1, 8 8 1'>
              </CoordinateInterpolator>
              <Shape>
                <IndexedTriangleStripSet index='0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20' solid='false'>              
                  <Coordinate DEF ='Coord' point='11 0 -0.2, 9 0 1, 8 8 1,  9 0 1, 8 0 -1, 8 7 1,  4 0 -3, 8 0 -1, 8 8 1,  4 0 -3, 8 0 -3, 8 8 1,   12 0 -1, 8 0 -3, 8 8 1,  12 0 1, 12 0 -1, 8 8 1,  11 0 0, 12 0 1, 8 8 1'></Coordinate>
                </IndexedTriangleStripSet>
                <Appearance>
                  <Material></Material>
                  <ImageTexture url="https://thumbs.dreamstime.com/b/предпосылка-текстуры-зимы-с-снегом-107272342.jpg" repeatS="false" repeatT="false">   
                  </ImageTexture>
                </Appearance>  
              </Shape>
            </Transform>
            <ROUTE fromNode='Time1' fromField='fraction_changed' toNode='CoordInt' toField='set_fraction'>
          </ROUTE>
          <ROUTE fromNode='CoordInt' fromField='value_changed' toNode='Coord' toField='set_point'>
        </ROUTE>
        <ROUTE fromNode='TrainCh' fromField='value_changed' toNode='train' toField='set_translation'>
        </ROUTE>
      </scene>
    </x3d>
    <input type="button" id="bt1" value="Поменять цвет" onClick='randomcolor()'>
    <div style="position: relative;">
    </div>
    </input>
  </body>
  </html>